### 1. React Query 소개

react query 란 React 앱의 서버 상태를 관리하는 라이브러리를 말한다.

React Query는 **클라이언트에서 서버 데이터 캐시를 관리**

> 클라이언트 상태와 서버 상태
>
> **클라이언트 상태**란 웹 브라우저 세션과 관련된 모든 정보를 의미
> ex) 사용자는 브라우저에서 사용 언어를 변경하거나 다크 모드 등을 설정할 수 있는데 이는 서버와는 아무런 관련이 없으며 단순히 사용자의 상태를 추적하는 것
> **서버 상태**는 서버에 저장되지만 클라이언트에 표시하는데 필요한 데이터
> ex) 데이터 베이스에 저장하는 블로그 게시물의 데이터가 이에 해당

즉, React에서 서버 데이터가 필요할 때 Fetch나 Axios를 이용해 서버로 바로 이동하지 않고 **React Query 캐시를 요청**

여기서 React Query의 역할은 React Query 클라이언트를 어떻게 구성했느냐에 따라 해당 캐시의 데이터를 유지 관리하는 것으로
데이터를 관리하는 것은 React Query이지만 서버의 새 데이터로 캐시를 업데이트하는 시기를 설정하는 것은 사용자의 몫

#### React Query가 서버에서 데이터를 관리하는 방법

React Query는 캐시에 있는 데이터에 키를 할당에서 데이터를 식별하는데 이 데이터가 서버의 데이터와 일치하는지 확인하는 두가지 방법이 있음

1. 명령형으로 처리
   : 퀴리 클라이언트에 이 데이터를 무효화하고 캐시에 교체할 새 데이터를 서버에서 가지고 오게 지시

2. 선언형으로 처리
   : 리패치(refetch)를 트리거하는 조건을 구성
   eX) 브라우저 창이 다시 포커스 되었을 때
   staleTime을 이용해 다시 가져오기를 언제 트리거할지 정할 수도 있음

#### React Query 연결

1.  라이브러리 설치
2.  쿼리 클라이언트 생성

- 쿼리를 관리하고 서버 데이터도 저장하는 클라이언트

3.  쿼리 공급자 적용

- 자식 컴포넌트에 캐시 및 클라이언트 구성을 제공할 쿼리 공급자 적용
- 이 프로바이더는 쿼리 클라이언트를 값으로 사용

4. useQuery hook 사용

- 이 훅이 서버에서 데이터를 가지고 옴

### 2. 쿼리 연결하기

1. 쿼리 클라이언트 만들기

여기에는 쿼리, 캐시, 쿼리 캐시를 조작하는 도구가 속함
하지만 대개 이 도구들을 직접 사용하진 않고 대신, 쿼리클라이언트를 속성으로 쓰는 QueryClientProvider를 추가
그럼 프로바이더 자식 컴포넌트가 리액트-쿼리 훅을 사용함

```js
// app.jsx

import { QueryClient, QueryClientProvideri } from "@tanstack/react-query";

const queryClient = new QueryClient();
// 새 쿼리클라이언트를 만들 수 있게 해줌
// 괄호안에 옵션을 넣을 수 있음

// 쿼리 클라이언트를 QueryClientProvider에 속성으로 추가

<QueryClientProvider client={queryClient}>
  <div className="App">
    <h1>Blog &apos;em Ipsum</h1>
    <Posts />
  </div>
</QueryClientProvider>;

//  이제 이 프로바이더의 자식들은 캐시를 포함한 쿼리클라이언트에 접근가능 리액트-쿼리의 다른 도구들도 사용가능
```
